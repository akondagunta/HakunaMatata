<html>

<head>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script src="introjs/intro.min.js"></script>
    <link href="introjs/introjs.min.css" rel="stylesheet" />
</head>

<body>
    <p id="step3">this is the step on the next page</p>
</body>

<script type="text/javascript">
    var InCloudTrnAppUrl = "https://hakunamatata.firebaseio.com";
    var InCloudTrnID = "-JhaPh6cH3KWGNK4sGIX";
    var pageUrl = location.protocol + '//' + location.host + location.pathname;
    var trainingStepsUrl = InCloudTrnAppUrl + "/steps/" + InCloudTrnID + "/.json";
</script>

<script type="text/javascript">
    $(document).ready(function () {
        startIntro();
    });

    function startIntro() {
        $.getJSON(trainingStepsUrl, function (data) {
            var training = {
                steps: []
            };

            var intro = introJs();
            var foundCurrentPage = false;
            var onCompleteIsSet = false;

            for (var key in data) {
                if (data.hasOwnProperty(key)) {
                    //check if the step is for this page
                    if (window.location.pathname.indexOf(data[key].page) > -1) {
                        var stepData = {};
                        stepData["intro"] = data[key].content;
                        stepData["element"] = data[key].element;
                        training.steps.push(stepData);
                        foundCurrentPage = true;

                    } else if (foundCurrentPage && !onCompleteIsSet) {
                        //set a callback for when the steps are completed on this page
                        intro.oncomplete(function () {
                            //head over to the next page!
                            window.location.href = data[key].page;
                        });
                        onCompleteIsSet = true;
                    }
                }
            }

            //TODO: use to record user steps completed for saving progress/analytics
            intro.onchange(function (target) {
                console.info("step");
            });
            intro.setOptions(training);
            intro.start();

        }).fail(function () {
            console.log("error");
        });
    }
</script>

</html>